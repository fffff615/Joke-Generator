<!doctype html>
<html lang="en">
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <meta charset="UTF-8" />
    <title>Joke Generator</title>
  </head>
  <body class="home">
    <main class="home__hero" aria-live="polite">
      <h1 class="home__title">Joke Generator</h1>
      <p class="home__subtitle">
        Need a smile? Press the button and let the punchlines roll.
      </p>
      <article class="joke-panel">
        <p class="joke-panel__prompt">
          Press the button to get your first joke.
        </p>
        <p class="joke-panel__setup" hidden></p>
        <p class="joke-panel__punchline" hidden></p>
      </article>
      <button class="generateAJokeButton" type="button">
        Get another joke
      </button>
    </main>
    <script>
      const jokeButton = document.querySelector('.generateAJokeButton');
      const promptEl = document.querySelector('.joke-panel__prompt');
      const setupEl = document.querySelector('.joke-panel__setup');
      const punchlineEl = document.querySelector('.joke-panel__punchline');
      const API_URL = 'https://official-joke-api.appspot.com/jokes/random';

      async function fetchJoke() {
        jokeButton.disabled = true;
        jokeButton.textContent = 'Loading...';
        promptEl.hidden = false;
        promptEl.textContent = 'Fetching something funnyâ€¦';
        setupEl.hidden = true;
        punchlineEl.hidden = true;
        try {
          const response = await fetch(API_URL);
          if (!response.ok) {
            throw new Error(`Request failed with ${response.status}`);
          }
          const { setup, punchline } = await response.json();
          promptEl.hidden = true;
          setupEl.hidden = false;
          punchlineEl.hidden = false;
          setupEl.textContent = setup;
          punchlineEl.textContent = punchline;
        } catch (error) {
          promptEl.hidden = false;
          promptEl.textContent =
            'Hmm, the punchline got lost. Try again in a moment.';
        } finally {
          jokeButton.disabled = false;
          jokeButton.textContent = 'Get another joke';
        }
      }

      jokeButton.addEventListener('click', fetchJoke);
    </script>
  </body>
</html>
